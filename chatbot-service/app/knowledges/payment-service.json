{"openapi":"3.1.0","info":{"title":"Payment Service API","description":"Payment processing service with VNPay provider integration.","version":"2.0.0"},"paths":{"/api/v1/payments/":{"post":{"tags":["Payments"],"summary":"Create Payment","operationId":"create_payment_api_v1_payments__post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaymentCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaymentInitResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Payments"],"summary":"List Payments","operationId":"list_payments_api_v1_payments__get","parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Page"}},{"name":"per_page","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Per Page"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/payments/{payment_id}":{"get":{"tags":["Payments"],"summary":"Get Payment","operationId":"get_payment_api_v1_payments__payment_id__get","parameters":[{"name":"payment_id","in":"path","required":true,"schema":{"type":"integer","title":"Payment Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/payments/{payment_id}/query":{"post":{"tags":["Payments"],"summary":"Query Payment Status","description":"Query VNPay for payment status and update database","operationId":"query_payment_status_api_v1_payments__payment_id__query_post","parameters":[{"name":"payment_id","in":"path","required":true,"schema":{"type":"integer","title":"Payment Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/webhooks/vnpay/ipn":{"get":{"tags":["VNPAY Webhook"],"summary":"Vnpay Ipn","operationId":"vnpay_ipn_api_v1_webhooks_vnpay_ipn_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/v1/webhooks/vnpay/return":{"get":{"tags":["VNPAY Webhook"],"summary":"Vnpay Return","operationId":"vnpay_return_api_v1_webhooks_vnpay_return_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/vnpay/return":{"get":{"summary":"Vnpay Return Redirect","description":"Redirect old VNPay return URL to new endpoint","operationId":"vnpay_return_redirect_vnpay_return_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/vnpay/ipn":{"get":{"summary":"Vnpay Ipn Redirect","description":"Redirect old VNPay IPN URL to new endpoint","operationId":"vnpay_ipn_redirect_vnpay_ipn_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"PaymentCreate":{"properties":{"booking_id":{"type":"string","title":"Booking Id"},"provider":{"type":"string","title":"Provider"},"amount":{"anyOf":[{"type":"number"},{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$"}],"title":"Amount"},"client_ip":{"type":"string","title":"Client Ip"}},"type":"object","required":["booking_id","provider","amount","client_ip"],"title":"PaymentCreate"},"PaymentInitResponse":{"properties":{"payment":{"$ref":"#/components/schemas/PaymentOut"},"url":{"type":"string","title":"Url"}},"type":"object","required":["payment","url"],"title":"PaymentInitResponse"},"PaymentOut":{"properties":{"id":{"type":"integer","title":"Id"},"booking_id":{"type":"string","title":"Booking Id"},"provider":{"type":"string","title":"Provider"},"amount":{"type":"string","pattern":"^(?!^[-+.]*$)[+-]?0*\\d*\\.?\\d*$","title":"Amount"},"status":{"type":"string","title":"Status"}},"type":"object","required":["id","booking_id","provider","amount","status"],"title":"PaymentOut"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}